{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n// export function fetchImages(userInput) {\n//   const keyApi = '46450573-9b5e41256c0ad0f1dd9121c30';\n//   let url = `https://pixabay.com/api/?key=${keyApi}&q=${userInput}&image_type=photo&orientation=horizontal&safesearch=true`;\n\n//   return fetch(url).then(response => {\n//     if (!response.ok) {\n//       throw new Error(response.status);\n//     } else {\n//       return response.json();\n//     }\n//   });\n// }\n\n// import { pages } from './main';\n\nexport let pages = 1;\n\nexport let maxPhoto = 15;\n\nexport function incrementPage() {\n  pages += 1;\n}\n\nexport function resetPage() {\n  pages = 1;\n}\n\nexport async function fetchImages(userInput) {\n  const keyApi = '46450573-9b5e41256c0ad0f1dd9121c30';\n  let url = `https://pixabay.com/api/?key=${keyApi}&q=${userInput}&image_type=photo&orientation=horizontal&safesearch=true&page=${pages}&per_page=3`;\n\n  const params = new URLSearchParams({\n    key: keyApi,\n    q: userInput,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: pages,\n    per_page: maxPhoto,\n  });\n\n  const response = await axios.get(`https://pixabay.com/api/?${params}`);\n\n  return response.data;\n}","import SimpleLightbox from 'simplelightbox';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\n\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchImages, pages, maxPhoto } from './pixabay-api';\nimport { closeBtn } from '../main';\n\nconst div = document.querySelector('.wrapp');\n\nconst list = document.querySelector('.list');\n\nexport function renderImages(data, lightbox) {\n  if (data.total === 0) {\n    list.innerHTML = '';\n    return undefined;\n  } else {\n    let max = Math.ceil(data.totalHits / maxPhoto);\n    if (max === pages) {\n      closeBtn();\n      iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageSize: 18,\n        messageLineHeight: 30,\n        position: 'topRight',\n      });\n    }\n    hideLoading();\n    const smallImg = data.hits\n      .map(\n        item =>\n          `<li class=\"list-item\"><a href=\"${item.largeImageURL}\" data-source=\"${item.largeImageURL}\"><img src=\"${item.webformatURL}\" alt=\"${item.tags}\" /></a>\n          <div class=\"wrapp-items\">\n          <div class=\"info-item\"><p class=\"bold\">Likes</p>\n          <p>${item.likes}</p>\n          </div>\n          <div class=\"info-item\"><p class=\"bold\">Views</p>\n          <p>${item.views}</p>\n          </div>\n          <div class=\"info-item\"><p class=\"bold\">Comments</p>\n          <p>${item.comments}</p>\n          </div>\n          <div class=\"info-item\"><p class=\"bold\">Downloads</p>\n          <p>${item.downloads}</p>\n          </div>\n\n          </div></li>`\n      )\n      .join('');\n\n    if (pages !== 1) {\n      list.insertAdjacentHTML('beforeend', smallImg);\n    } else {\n      list.innerHTML = smallImg;\n    }\n\n    lightbox.refresh();\n    return true;\n  }\n}\n\nexport function showLoading() {\n  div.style.display = 'block';\n}\n\nexport function hideLoading() {\n  div.style.display = 'none';\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport {\n  fetchImages,\n  incrementPage,\n  pages,\n  resetPage,\n} from './js/pixabay-api.js';\nimport {\n  renderImages,\n  showLoading,\n  hideLoading,\n} from './js/render-functions.js';\n\nconst body = document.querySelector('body');\nlet lightbox = new SimpleLightbox('.list a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  loop: true,\n});\n\nlet width;\n\nconst form = document.querySelector('.form');\nconst userInput = document.querySelector('.user-input');\nconst btnPages = document.querySelector('.test1');\n\nfunction showBtn() {\n  btnPages.style.display = 'block';\n}\n\nexport function closeBtn() {\n  btnPages.style.display = 'none';\n}\n\ncloseBtn();\n\nlet userText;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  if (userInput.value.trim()) {\n    userText = userInput.value.trim();\n    resetPage();\n    btnPages.removeEventListener('click', loadMoreImages);\n  } else {\n    userText = undefined;\n  }\n\n  if (userText) {\n    showLoading();\n    try {\n      const data = await fetchImages(userText);\n      if (!renderImages(data, lightbox)) {\n        throw new Error('No images found!');\n      } else {\n        if (data.hits.length < 15) {\n          closeBtn();\n        } else {\n          showBtn();\n        }\n\n        btnPages.addEventListener('click', loadMoreImages);\n      }\n    } catch (error) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Oops, something went wrong. Please try again later.',\n        messageSize: 18,\n        messageLineHeight: 30,\n        position: 'topRight',\n      });\n    } finally {\n      hideLoading();\n    }\n  }\n});\n\nasync function loadMoreImages() {\n  incrementPage();\n  try {\n    showLoading();\n    const data = await fetchImages(userText);\n    if (data.hits.length === 0) {\n      closeBtn();\n      iziToast.warning({\n        message: 'No more images to load.',\n        messageSize: 18,\n        messageLineHeight: 30,\n        position: 'topRight',\n      });\n      return;\n    }\n    renderImages(data, lightbox);\n\n    if (data.hits.length < 15) {\n      closeBtn();\n    } else {\n      showBtn();\n    }\n\n    window.scrollTo({\n      top: document.body.scrollHeight,\n      behavior: 'smooth',\n    });\n\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Oops, something went wrong. Please try again later.',\n      messageSize: 18,\n      messageLineHeight: 30,\n      position: 'topRight',\n    });\n  } finally {\n    hideLoading();\n  }\n}\n\nfunction update() {\n  const elem = document.querySelector('.list');\n  const rect = elem.getBoundingClientRect();\n  if (rect.height) {\n    width = rect.height;\n  }\n};"],"names":["pages","maxPhoto","incrementPage","resetPage","fetchImages","userInput","keyApi","params","axios","div","list","renderImages","data","lightbox","closeBtn","iziToast","hideLoading","smallImg","item","showLoading","SimpleLightbox","form","btnPages","showBtn","userText","event","loadMoreImages"],"mappings":"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"}